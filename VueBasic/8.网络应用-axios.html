<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8.网络应用-axios</title>
  </head>
  <body>
    <!-- axios基本使用 -->
    <input type="button" value="get请求" class="get" />
    <input type="button" value="post请求" class="post" />

    <!-- axios结合vue -->
    <div id="app">
      <input type="button" value="获取笑话" @click="getJoke" />
      <p>{{joke}}</p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- axios.get(url?key=value&key2=values).then(function(response){},function(err){}) -->
    <!-- axios.post(url,{key:value,key2:values}).then(function(response){},function(err){}) -->
    <script>
      /*
        接口1：随机笑话
        请求地址：https://autumnfish.cn/api/joke/list
        请求方法：get
        请求参数：num(笑话个数)
        响应内容：随机笑话
      */
      document.querySelector(".get").onclick = function () {
        axios.get("https://autumnfish.cn/api/joke/list?num=4").then(
          function (response) {
            console.log(response);
          },
          function (err) {
            console.log(err);
          }
        );
      };
      /*
        接口2：用户注册
        请求地址：https://autumnfish.cn/api/reg
        请求方法：post
        请求参数：username
        响应内容：注册成功或失败
      */
      document.querySelector(".post").onclick = function () {
        axios
          .get("https://autumnfish.cn/api/reg", { username: "shenpotato" })
          .then(
            function (response) {
              console.log(response);
            },
            function (err) {
              console.log(err);
            }
          );
      };
      /*
        接口3：随机笑话
        请求地址：https://autumnfish.cn/api/joke
        请求方法：get
        请求参数：无
        响应内容：随机笑话
      */
      var app = new Vue({
        el: "#app",
        data: {
          joke: "一个笑话",
        },
        methods: {
          getJoke: function () {
            var that = this;
            axios.get("https://autumnfish.cn/api/joke").then(
              function (response) {
                that.joke = response.data;
              },
              function (err) {
                console.log(err);
              }
            );
          },
        },
      });
    </script>
  </body>
</html>
